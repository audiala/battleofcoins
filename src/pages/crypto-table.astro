---
import Layout from '../layouts/Layout.astro';
import CryptoTableComponent from '../components/CryptoTable';
import '../styles/crypto-table.css';
import { readFileSync, readdirSync } from 'fs';
import { join } from 'path';
import { load } from 'js-yaml';
import '../styles/main.css';
import type { CryptoData } from '../components/CryptoTable';
import taggedCoinsData from '../../data/tagged_coins.json';

// Read the YAML file
const dataDir = join(process.cwd(), 'data');
const files = readdirSync(dataDir);
const latestFile = files
  .filter(f => f.startsWith('top_500_coins_'))
  .sort()
  .reverse()[0];

const yamlContent = readFileSync(join(dataDir, latestFile), 'utf8');
const cryptoData = load(yamlContent) as CryptoData[];

console.log('Loaded crypto data:', cryptoData.length);
---

<Layout title="Crypto Table">
  <div class="w-full">
    <CryptoTableComponent 
      client:load 
      data={cryptoData} 
      taggedCoins={taggedCoinsData} 
    />
  </div>
</Layout>

<style is:global>
  /* Add these styles directly in the Astro component */
  tr[style*="background-color"] {
    background-color: rgba(245, 62, 152, 0.15) !important;
  }

  tr[style*="background-color"]:hover {
    background-color: rgba(245, 62, 152, 0.25) !important;
  }

  tr {
    transition: background-color 0.2s ease !important;
  }
</style> 