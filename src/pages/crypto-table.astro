---
import Layout from '../layouts/Layout.astro';
import CryptoTable from '../components/CryptoTable';
import '../styles/crypto-table.css';
import { readFileSync, readdirSync } from 'fs';
import { join } from 'path';
import { load } from 'js-yaml';
import '../styles/main.css';

// Read the YAML file
const dataDir = join(process.cwd(), 'data');
const files = readdirSync(dataDir);
const latestFile = files
  .filter(f => f.startsWith('top_500_coins_'))
  .sort()
  .reverse()[0];

const yamlContent = readFileSync(join(dataDir, latestFile), 'utf8');
const cryptoData = load(yamlContent);

---

<Layout title="Crypto Table">
  <CryptoTable client:load data={cryptoData} />
</Layout> 